<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ config.APP_NAME ~ ' - System Wyborczy' }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/xlsx_import.css') }}">
 <style>
        body { background-color: #f4f7f6; overflow-x: hidden; }
        #wrapper { display: flex; width: 100%; align-items: stretch; }
        #sidebar-wrapper {
            min-width: 280px; max-width: 280px;
            background: #212529; color: #fff;
            transition: all 0.3s; min-height: 100vh;
        }
        .sidebar-scroll { max-height: calc(100vh - 120px); overflow-y: auto; }
        .list-group-item { background: transparent; color: #adb5bd; border: none; padding: 10px 20px; font-size: 0.9rem; }
        .list-group-item:hover { background: #343a40; color: #fff; }
        .list-group-item.active { background: #0d6efd; color: #fff; border-radius: 0; }
        .navbar { background-color: #1a1d20 !important; padding: 0.5rem 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,.1); }
        #page-content-wrapper { width: 100%; }
        .status-dot { height: 10px; width: 10px; border-radius: 50%; display: inline-block; }
        .sidebar-logo { max-height: 40px; width: auto; margin-right: 10px; }
        
        /* Ukrywanie sidebaru dla widoków pełnoekranowych */
        .sidebar-hidden { display: none !important; }
        .btn-status {height: 36px; display: inline-flex; align-items: center; line-height: 1;}
        
        /*bez spinerów*/
        .no-spinner::-webkit-inner-spin-button,
        .no-spinner::-webkit-outer-spin-button {
         -webkit-appearance: none;
                 margin: 0;
                }
         .no-spinner {
             -moz-appearance: textfield;
                }

    </style>
</head>
<body>

<div id="wrapper">
    {% set full_width_pages = ['lista_operatorow', 'lista_kandydatow'] %}
    <div id="sidebar-wrapper" class="border-end border-secondary {{ 'sidebar-hidden' if request.endpoint in full_width_pages }}">
        <div class="p-3 border-bottom border-secondary d-flex justify-content-between align-items-center">
            <small class="text-uppercase fw-bold text-white-50" style="font-size: 1rem; letter-spacing: 1px;">
                <i class="bi bi-list-ul me-2"></i>Lista Obwodów
            </small>
        </div>
        <div class="sidebar-scroll">
            <div class="list-group list-group-flush">
                {% for i in lista_widocznych_obwodow %}
                <a href="{{ url_for('dashboard', nr=i) }}" 
                   class="list-group-item list-group-item-action d-flex justify-content-between align-items-center {{ 'active' if wybrano_nr == i }}">
                    <span>Obwód Nr {{ i }}</span>
                    {% if statusy and statusy.get(i) == 'zatw' %}<span class="status-dot bg-success"></span>
                    {% elif statusy and statusy.get(i) == 'edit' %}<span class="status-dot bg-warning"></span>
                    {% else %}<span class="status-dot bg-secondary"></span>{% endif %}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <div id="page-content-wrapper">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
            <div class="container-fluid">
                <div class="d-flex align-items-center">
                    <img src="{{ url_for('static', filename='img/herb_zabrza.png') }}" alt="Herb" class="sidebar-logo">
                    <h4 class="fw-bold mb-0 text-primary">{{ config.APP_NAME ~ ' v' ~ config.VERSION }}</h4>
                </div>
                
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto align-items-center">
                        <li class="nav-item me-2">
                            <a class="btn {{ 'btn-primary' if request.endpoint in ['dashboard', 'index'] else 'btn-outline-primary' }} btn-sm px-3" href="{{ url_for('index') }}">
                                <i class="bi bi-file-earmark-ruled me-1"></i> Protokoły
                            </a>
                        </li>

                        {% if current_user.rola == 'ADMIN' %}
                        <li class="nav-item me-2">
                            <a class="btn {{ 'btn-warning' if request.endpoint == 'lista_kandydatow' else 'btn-outline-warning' }} btn-sm px-3" href="{{ url_for('lista_kandydatow') }}">
                                <i class="bi bi-person-lines-fill me-1"></i> Kandydaci
                            </a>
                        </li>
                        <li class="nav-item me-3">
                            <a class="btn {{ 'btn-info' if request.endpoint == 'lista_operatorow' else 'btn-outline-info' }} btn-sm px-3" href="{{ url_for('lista_operatorow') }}">
                                <i class="bi bi-people-fill me-1"></i> Operatorzy
                            </a>
                        </li>
                        {% endif %}
                        
                        <li class="nav-item text-white-50 small me-3">
                            <strong>{{ current_user.login }}</strong> 
                            <span class="badge bg-secondary ms-1">{{ current_user.rola }}</span>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-danger btn-sm px-3" href="{{ url_for('logout') }}"><i class="bi bi-box-arrow-right me-1"></i> Wyloguj</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container-fluid px-4">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}{% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show shadow-sm">
                        {{ message|safe }}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}{% endif %}
            {% endwith %}
            {% block content %}{% endblock %}
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="{{ url_for('static', filename='js/xlsx_import.js') }}"></script>
</body>
</html>